Flow org.gluu.agama.typekey
     Basepath ""
Log "@info " Starting typekey authentication
idp = Call org.gluu.agama.typekey.IdentityProcessor#new 
tk = Call org.gluu.agama.typekey.Typekey#new conf
user = RRF "typekey/username.ftlh" 
userData = Call idp accountFromUsername user.username
When userData.empty is true
     it_wzqox = {success:false, error: "User not found"}
     Finish it_wzqox
enrolled = Call idp enrolled user.username
When enrolled is false
     random_usecase = Call tk getRandomUseCase 
     phrase_map = Call tk generateTypekeyData random_usecase
     dummy = Call idp enroll user.username phrase_map
     phrase = phrase_map.phrase
     use_case = random_usecase
it_taewl = {success:true, data: { userId: "as9233Qz", property1: "value1"}}
Finish it_taewl